import React, { useState } from 'react';

function FileUploadWithValidation() {
  const [selectedFile, setSelectedFile] = useState(null);
  const [error, setError] = useState('');

  const handleFileChange = (event) => {
    const file = event.target.files[0];
    if (file) {
      // Reset previous errors
      setError('');

      // Validate file type
      if (file.type !== 'text/csv' && !file.name.endsWith('.csv')) {
        setError('Please select a CSV file.');
        return;
      }

      // Optional: Validate file size (e.g., not larger than 5MB)
      const maxFileSize = 5 * 1024 * 1024; // 5MB
      if (file.size > maxFileSize) {
        setError('File size should not exceed 5MB.');
        return;
      }

      // If validation passes, update state with the selected file
      setSelectedFile(file);
    }
  };

  const handleFileUpload = () => {
    if (!selectedFile) {
      alert('Please select a file first!');
      return;
    }

    // Here, implement the file upload logic to your backend or cloud storage
    console.log('Uploading file:', selectedFile.name);
    // Reset the selected file after upload
    setSelectedFile(null);
  };

  return (
    <div>
      <input
        type="file"
        accept=".csv"
        onChange={handleFileChange}
      />
      <button onClick={handleFileUpload}>Upload File</button>
      {selectedFile && <p>File selected: {selectedFile.name}</p>}
      {error && <p style={{ color: 'red' }}>{error}</p>}
    </div>
  );
}

export default FileUploadWithValidation;
